function rsmg_show_message(a,b,c,d){a("#rsmg_info").empty();a("#rsmg_info").show();var e=a("<p>",{"class":c}).html(b).hide();a("#rsmg_info").append(e.show("fade",{},600));if(!d){setTimeout(function(){e.hide("fade",function(){a(this).remove()},600)},3e3)}}function rsmg_show_selected(a){var b=a("#rsmg_items").children(".ui-selected").length;var c=parseInt(a("#rsmg_load_more").attr("rel"))+a("#rsmg_items").children("li").length;if(a("#rsmg_select_all").attr("rel")&&a("#rsmg_select_all").attr("rel")==1)b=c;message=rsmg_get_lang("RSMG_SELECTED_ITEMS").replace("%d",b).replace("%d",c);rsmg_show_message(a,message,"rsmg_selected",true)}function rsmg_submit(a,b){switch(b){case"save":rsmg_save_details(a);return;break;case"apply":rsmg_save_details(a,true);return;break;case"cancel":rsmg_close_details(a,true);return;break;case"upload":a("#dialog:ui-dialog").dialog("destroy");a("#rsmg_dialog_upload").dialog({height:330,width:430,modal:true,draggable:false,resizable:false,buttons:[{text:rsmg_get_lang("RSMG_CLOSE"),click:function(){a(this).dialog("close")}}]});return;break}var c=a("ul#rsmg_items li.rsmg_item.ui-selected").children('input[name="cid[]"]');if(c.length==0){a("#dialog:ui-dialog").dialog("destroy");a("#rsmg_dialog_message").dialog({height:400,width:400,modal:true,draggable:false,resizable:false,buttons:[{text:rsmg_get_lang("RSMG_CLOSE"),click:function(){a(this).dialog("close")}}]})}else{var d=new Array;c.each(function(b,c){d.push(a(c).val())});switch(b){case"remove":var e=c.parents("li.rsmg_item");rsmg_del_items(a,e,d);break;case"publish":if(c.parents("li.rsmg_item").children("div.rsmg_publish").hasClass("rsmg_publish_loading"))return false;rsmg_publish_items(a,d,function(){c.parents("li.rsmg_item").children("div.rsmg_publish").removeClass("rsmg_publish_loading").addClass("rsmg_published").children("span").html(rsmg_get_lang("RSMG_PUBLISHED"))},function(){c.parents("li.rsmg_item").children("div.rsmg_publish").removeClass("rsmg_published").removeClass("rsmg_unpublished").addClass("rsmg_publish_loading")});break;case"unpublish":if(c.parents("li.rsmg_item").children("div.rsmg_publish").hasClass("rsmg_publish_loading"))return false;rsmg_unpublish_items(a,d,function(){c.parents("li.rsmg_item").children("div.rsmg_publish").removeClass("rsmg_publish_loading").addClass("rsmg_unpublished").children("span").html(rsmg_get_lang("RSMG_UNPUBLISHED"))},function(){c.parents("li.rsmg_item").children("div.rsmg_publish").removeClass("rsmg_published").removeClass("rsmg_unpublished").addClass("rsmg_publish_loading")});break;case"tag":a("#dialog:ui-dialog").dialog("destroy");a("#rsmg_dialog_tag").dialog({width:400,modal:true,draggable:false,resizable:false,buttons:[{text:rsmg_get_lang("RSMG_SAVE_CHANGES"),click:function(){if(a("#rsmg_tags_text").val().trim().length==0){a("#rsmg_tags_text").val("");a("#rsmg_tags_text_error").show("fade",{},600);setTimeout(function(){a("#rsmg_tags_text_error").hide("fade",{},600)},3e3);return}a("#rsmg_tags_text_error").hide();a(this).dialog("close");selectall=a("#rsmg_select_all").attr("rel")==1?1:0;a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task="+(a("#rsmg_action0:checked").length>0?"tagitems":"untagitems")+"&format=raw",data:{"cid[]":d,tags:a("#rsmg_tags_text").val(),selectall:selectall},success:function(b){a("#rsmg_tags_text").val("");var c=a("#rsmg_action0:checked").length>0?rsmg_get_lang("RSMG_TAGS_HAVE_BEEN_ADDED"):rsmg_get_lang("RSMG_TAGS_HAVE_BEEN_REMOVED");rsmg_show_message(a,c,"rsmg_sucess")}})}},{text:rsmg_get_lang("RSMG_CANCEL"),click:function(){a("#rsmg_tags_text_error").hide();a(this).dialog("close")}}]});break}}}function rsmg_save_details(a,b){var c=0;var d=null;a("li.rsmg_item").each(function(b,e){if(a(e).css("display")=="block"){c=a(e).children('input[name="cid[]"]').val();d=a(e)}});a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=saveitem&format=raw",data:{cid:c,title:a("#rsmg_detail_title").val(),tags:a("#rsmg_detail_tags").val(),description:a("#rsmg_detail_description").val(),url:a("#rsmg_detail_url").val(),hits:a("#rsmg_detail_hits").val(),published:a("#rsmg_detail_published").attr("checked")?1:0,x1:a("#rsmg_x1").val(),y1:a("#rsmg_y1").val(),x2:a("#rsmg_x2").val(),y2:a("#rsmg_y2").val(),w:a("#rsmg_w").val(),h:a("#rsmg_h").val()},beforeSend:function(){a(".rsmg_button_apply").hide();a(".rsmg_button_save").hide();a(".rsmg_button_cancel").hide();a("#rsmg_detail_loader").show()},success:function(c){a(".rsmg_button_apply").show();a(".rsmg_button_save").show();a(".rsmg_button_cancel").show();a("#rsmg_detail_loader").hide();if(typeof c=="object"){if(c.success==1){var e=Math.floor(Math.random()*1000001);var f=c.item;var g=d.find("img");g.attr("title",f.title);g.attr("thumb-src",rsmg_get_root()+"/components/com_rsmediagallery/assets/gallery/"+f.filename+"?skipcache="+e);if(f.published==1){d.find("div.rsmg_publish").removeClass("rsmg_publish_loading").removeClass("rsmg_unpublished").addClass("rsmg_published").children("span").html(rsmg_get_lang("RSMG_PUBLISHED"))}else{d.find("div.rsmg_publish").removeClass("rsmg_publish_loading").removeClass("rsmg_published").addClass("rsmg_unpublished").children("span").html(rsmg_get_lang("RSMG_UNPUBLISHED"))}if(!b)rsmg_close_details(a,false);rsmg_show_message(a,rsmg_get_lang("RSMG_ITEM_SAVED"),"rsmg_sucess")}else{a("#rsmg_save_result").addClass("rsmg_error").html(c.message)}}}})}function rsmg_close_details(a,b){rsmg_show_filter_toolbar(a);rsmg_show_default_toolbar(a);if(typeof a("#rsmg_load_more").attr("rel")!="undefined"&&parseInt(a("#rsmg_load_more").attr("rel"))>0)a("#rsmg_load_more").show("fade",500);if(b)a("#rsmg_info").hide("fade",500,function(){rsmg_show_selected(a)});a("#rsmg_box_thumb img").hide();a("#rsmg_box_thumb img").imgAreaSelect({remove:true});a(".rsmg_thumb_container").children("img").each(function(b,c){a(c).attr("src",a(c).attr("thumb-src"));a(c).removeAttr("style")});a("#rsmg_item_detail").hide("blind",{direction:"left"},500,function(){rsmg_show_items(a)})}function rsmg_unpublish_items(a,b,c,d,e){if(typeof c!="function")c=function(){};if(typeof d!="function")d=function(){};selectall=a("#rsmg_select_all").attr("rel")==1&&!e?1:0;a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=unpublishitems&format=raw",data:{"cid[]":b,selectall:selectall},success:c,beforeSend:d})}function rsmg_publish_items(a,b,c,d,e){if(typeof c!="function")c=function(){};if(typeof d!="function")d=function(){};selectall=a("#rsmg_select_all").attr("rel")==1&&!e?1:0;a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=publishitems&format=raw",data:{"cid[]":b,selectall:selectall},success:c,beforeSend:d})}function rsmg_del_items(b,c,d,e){selectall=b("#rsmg_select_all").attr("rel")==1&&!e?1:0;c.trigger("startRumble");b("#dialog:ui-dialog").dialog("destroy");b("#rsmg_dialog_confirm_delete").dialog({beforeClose:function(){c.trigger("stopRumble")},resizable:false,modal:true,draggable:false,title:rsmg_get_lang("RSMG_ARE_YOU_SURE"),buttons:[{text:rsmg_get_lang("RSMG_DELETE"),click:function(){b(this).dialog("close");c.hide("highlight",500,function(){b(this).remove()});temp_cid=d;if(typeof temp_cid!="array"&&typeof temp_cid!="object")temp_cid=[d];for(t=0;t<temp_cid.length;t++){for(a=0;a<rsmg_sort_array.length;a++)if(rsmg_sort_array[a].id==temp_cid[t]){rsmg_sort_array.splice(a,1);break}}selectall=b("#rsmg_select_all").attr("rel")==1?1:0;b.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=delitems&format=raw",data:rsmg_get_items_filter(b,{"cid[]":d,selectall:selectall}),success:function(a){if(typeof a=="object"&&a.items){rsmg_show_message(b,rsmg_get_lang(temp_cid.length>1?"RSMG_ITEMS_DELETED":"RSMG_ITEM_DELETED"),"rsmg_sucess");if(a.total>b("ul#rsmg_items li.rsmg_item").length){var c=a.total-b("ul#rsmg_items li.rsmg_item").length;b("#rsmg_load_more").html(rsmg_get_lang("RSMG_LOAD_MORE").replace("%d",c));b("#rsmg_load_more").attr("rel",c);b("#rsmg_load_more").show("fade",500)}else{var c=0;b("#rsmg_load_more").html(rsmg_get_lang("RSMG_LOAD_MORE").replace("%d",c));b("#rsmg_load_more").attr("rel",c)}}}})}},{text:rsmg_get_lang("RSMG_CANCEL"),click:function(){b(this).dialog("close")}}]})}function rsmg_init_details_buttons(a){a(".rsmg_button_cancel").click(function(b){b.preventDefault();rsmg_close_details(a,true)}).button({icons:{primary:"ui-icon-close"}});a(".rsmg_button_save").click(function(b){b.preventDefault();rsmg_save_details(a)}).button({icons:{primary:"ui-icon-disk"}});a(".rsmg_button_apply").click(function(b){b.preventDefault();rsmg_save_details(a,true)}).button({icons:{primary:"ui-icon-check"}});a("#rsmg_save_form").submit(function(b){b.preventDefault();a(".rsmg_button_save").trigger("click")})}function rsmg_init_upload(a){a("#rsmg_add_files").fileupload({autoUpload:true,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,dataType:"json",url:"index.php?option=com_rsmediagallery&controller=items&task=uploaditem&format=raw",sequentialUploads:true,start:function(b){a("#rsmg_dialog_upload").dialog("option","buttons",[{text:rsmg_get_lang("RSMG_PLEASE_WAIT"),click:function(){return false}}]);a(".ui-dialog .ui-button-text").append(a("<img>",{src:"components/com_rsmediagallery/assets/images/loader-small-trans.gif"}))},stop:function(b){a("#rsmg_dialog_upload").dialog("option","buttons",[{text:rsmg_get_lang("RSMG_CLOSE"),click:function(){a(this).dialog("close");rsmg_get_items(a,true)}}])},add:function(b,c){var d=a(this).data("fileupload").options;var e=true;if(!d.acceptFileTypes)return e;a.each(c.files,function(a,b){if(!d.acceptFileTypes.test(b.type)&&!d.acceptFileTypes.test(b.name))e=false});if(e&&d.autoUpload==true)c.submit()},done:function(b,c){if(c.result&&typeof c.result=="object"){if(c.result.success==1&&a("#rsmg_add_tags_text").val().trim().length>0){a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=tagitems&format=raw",data:{"cid[]":c.result.id,tags:a("#rsmg_add_tags_text").val()}})}a("#rsmg_add_results").prepend(a("<li>",{"class":c.result.error==1?"rsmg_error":"rsmg_success"}).html(c.result.message))}}})}function rsmg_init_load_more(a){a("#rsmg_load_more").click(function(b){b.preventDefault();b.shiftKey?rsmg_get_items(a,false,{limitall:1,limit:a("#rsmg_load_more").attr("rel")}):rsmg_get_items(a)});a(document).keydown(function(b){if(b.shiftKey){a("#rsmg_load_more").html(rsmg_get_lang("RSMG_LOAD_ALL").replace("%d",a("#rsmg_load_more").attr("rel")));a("#rsmg_select_all").html(rsmg_get_lang("RSMG_SELECT_ALL_PAGES").replace("%d",parseInt(a("#rsmg_load_more").attr("rel"))+parseInt(a("ul#rsmg_items li.rsmg_item").length)))}});a(document).keyup(function(b){a("#rsmg_load_more").html(rsmg_get_lang("RSMG_LOAD_MORE").replace("%d",a("#rsmg_load_more").attr("rel")));a("#rsmg_select_all").html(rsmg_get_lang("RSMG_SELECT_ALL"))})}function rsmg_init_items(a){rsmg_init_sortable(a);rsmg_init_selectable(a);rsmg_init_rumble(a);rsmg_init_pic_toolbar(a);rsmg_init_tooltips(a)}function rsmg_get_items(a,b,c){var d=a("#rsmg_items");if(b==true){rsmg_sort_array=[];d.empty()}a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=getitems&format=raw",data:rsmg_get_items_filter(a,c),beforeSend:function(){var b=a("<li>",{"class":"rsmg_item",id:"rsmg_loader_container"});var c=a("<div>",{id:"rsmg_loader"});b.append(c);d.append(b);a("#rsmg_load_more").hide("fade",500)},success:function(c){a("#rsmg_loader_container").remove();if(typeof c=="object"&&c.items&&c.total){a(c.items).each(function(b,c){rsmg_sort_array.push({id:c.id,ordering:c.ordering});var e=a("<input>",{type:"hidden",name:"cid[]",value:c.id});var f=a("<li>",{"class":"rsmg_item"});if(a("#rsmg_select_all").attr("rel")==1)f.addClass("ui-selected");var g=a("<div>",{"class":"rsmg_thumb_container"});var h=a("<img>",{src:rsmg_get_root()+"/components/com_rsmediagallery/assets/gallery/"+c.filename,alt:c.title,"original-src":rsmg_get_root()+"/components/com_rsmediagallery/assets/gallery/original/"+c.filename,"thumb-src":rsmg_get_root()+"/components/com_rsmediagallery/assets/gallery/"+c.filename,"original-width":c.params.info[0],"original-height":c.params.info[1]});g.append(h);var i=a("<span>",{"class":"rsmg_clear"});if(c.published==1){var j=a("<div>",{"class":"rsmg_action_button rsmg_publish rsmg_published",title:rsmg_get_lang("RSMG_UNPUBLISH_DESC")});var k=a("<span>").html(rsmg_get_lang("RSMG_PUBLISHED"))}else{var j=a("<div>",{"class":"rsmg_action_button rsmg_publish rsmg_unpublished",title:rsmg_get_lang("RSMG_PUBLISH_DESC")});var k=a("<span>").html(rsmg_get_lang("RSMG_UNPUBLISHED"))}j.append(k);var l=a("<dl>");var m=a("<dt>");var n=a("<a>",{"class":"rsmg_action_button rsmg_edit",href:"#",title:rsmg_get_lang("RSMG_EDIT_DESC")});var o=a("<dt>");var p=a("<a>",{"class":"rsmg_action_button rsmg_preview",href:"#",title:rsmg_get_lang("RSMG_PREVIEW_DESC")});var q=a("<dt>");var r=a("<a>",{"class":"rsmg_action_button rsmg_delete",href:"#",title:rsmg_get_lang("RSMG_DELETE_DESC")});m.append(n);o.append(p);q.append(r);l.append(o,m,q);f.append(e,g,i,j,l);d.append(f)});rsmg_init_items(a);if(c.total>a("ul#rsmg_items li.rsmg_item").length){var e=c.total-a("ul#rsmg_items li.rsmg_item").length;a("#rsmg_load_more").html(rsmg_get_lang("RSMG_LOAD_MORE").replace("%d",e));a("#rsmg_load_more").attr("rel",e);a("#rsmg_load_more").show("fade",500)}else{var e=0;a("#rsmg_load_more").html(rsmg_get_lang("RSMG_LOAD_MORE").replace("%d",e));a("#rsmg_load_more").attr("rel",e)}if(b)rsmg_show_selected(a)}}})}function rsmg_get_items_filter(a,b){var c=[];a('input[name="rsmg_columns[]"]').each(function(b,d){c.push(a(d).val())});if(c.length==0)c="";var d=[];a('input[name="rsmg_operators[]"]').each(function(b,c){d.push(a(c).val())});if(d.length==0)d="";var e=[];a('input[name="rsmg_values[]"]').each(function(b,c){e.push(a(c).val())});if(e.length==0)e="";var f={limit:a("#rsmg_limit ul li a.rsmg_tick").attr("rel"),limitstart:a("ul#rsmg_items li.rsmg_item").length,"filter_columns[]":c,"filter_operators[]":d,"filter_values[]":e,order:a("#rsmg_order ul li a.rsmg_tick").attr("rel"),direction:a("#rsmg_direction ul li a.rsmg_tick").attr("rel")};if(b)for(var g in b)f[g]=b[g];return f}function rsmg_show_default_toolbar(a){a("#rsmg_toolbar_edit").hide("fade",500);a("#rsmg_toolbar_default").show("fade",500)}function rsmg_show_edit_toolbar(a){a("#rsmg_toolbar_default").hide("fade",500);a("#rsmg_toolbar_edit").show("fade",500)}function rsmg_hide_filter_toolbar(a){a(".rsmg_filter_toolbar").hide();a("#rsmg_filter").hide();a("#rsmg_select_all").hide()}function rsmg_show_filter_toolbar(a){a(".rsmg_filter_toolbar").show();a("#rsmg_filter").show();a("#rsmg_select_all").show()}function rsmg_show_items(a){a("#rsmg_items").addClass("rsmg_full_width");a(".rsmg_item").css("display","block");a("#rsmg_items").selectable({disabled:false});rsmg_init_sortable(a)}function rsmg_hide_items(a){a(".rsmg_item").css("display","none");a("#rsmg_items").selectable({disabled:true});a("#rsmg_items").sortable({disabled:true})}function rsmg_init_pic_toolbar(a){a(".rsmg_delete").unbind("click");a(".rsmg_delete").click(function(){if(a("#rsmg_item_detail").css("display")=="block"){return}var b=a(this);var c=b.parents("li.rsmg_item");var d=c.children('input[name="cid[]"]').val();rsmg_del_items(a,c,d,true)});a(".rsmg_edit").unbind("click");a(".rsmg_edit").click(function(b){b.preventDefault();a("#rsmg_items").css("opacity","1");a("#rsmg_items").removeClass("rsmg_full_width");if(a.browser.msie)a("#rsmg_items").css("opacity","100%");a("#rsmg_items").css("cursor","default");var c=a(this).parents(".rsmg_item");rsmg_hide_items(a);c.css("display","block");if(c.find(".rsmg_thumb_container_loading").length>0||a("#rsmg_item_detail").css("display")=="block")return;c.find(".rsmg_thumb_container").append(a("<div>",{"class":"rsmg_thumb_container_loading"}));rsmg_hide_filter_toolbar(a);a("#rsmg_load_more").hide("fade",500);rsmg_show_edit_toolbar(a);a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=getitem&format=raw",data:{cid:c.children('input[name="cid[]"]').val()},beforeSend:function(){a("#rsmg_detail_title").val("");a("#rsmg_detail_description").val("");a("#rsmg_detail_url").val("");a("#rsmg_detail_tags").val("");a("#rsmg_detail_hits").val("");a("#rsmg_save_result").html("").removeClass("rsmg_error")},success:function(b){if(typeof b=="object"&&b.id){var d=c.find("img").attr("original-src");a("#rsmg_box_thumb img").unbind("load");a("#rsmg_box_thumb img").attr("src",d).load(function(){if(a.browser.msie)a("#rsmg_box_thumb img").unbind("load");if(!b.params.selection)b.params.selection={x1:0,x2:380,y1:0,y2:a("#rsmg_box_thumb img").height()};a("#rsmg_detail_title").val(b.title);a("#rsmg_detail_description").val(b.description);a("#rsmg_detail_url").val(b.url);a("#rsmg_detail_tags").val(b.tags);a("#rsmg_detail_published").attr("checked",b.published==1);a("#rsmg_detail_hits").val(b.hits);a("#rsmg_created_date").html(b.created);a("#rsmg_modified_date").html(b.modified);rsmg_show_message(a,b.title,"rsmg_editing",true);c.find("img").attr("src",d);a("#rsmg_item_detail").show("blind",{direction:"left"},500,function(){a("#rsmg_box_thumb img").show();a("#rsmg_box_thumb img").imgAreaSelect({aspectRatio:"4:3",disable:false,hide:false,handles:true,persistent:true,fadeSpeed:200,onSelectEnd:function(b,c){if(!c.width||!c.height)return;a("#rsmg_x1").val(c.x1);a("#rsmg_y1").val(c.y1);a("#rsmg_x2").val(c.x2);a("#rsmg_y2").val(c.y2);a("#rsmg_w").val(c.width);a("#rsmg_h").val(c.height)},onSelectChange:function(a,b){if(!b.width||!b.height)return;var d=280/b.width;var e=210/b.height;c.find("img").css({width:Math.round(d*a.width),height:Math.round(e*a.height),marginLeft:-Math.round(d*b.x1),marginTop:-Math.round(e*b.y1)})},onInit:function(b,d){c.find(".rsmg_thumb_container_loading").remove();if(!d.width||!d.height)return;var e=280/d.width;var f=210/d.height;c.find("img").css({width:Math.round(e*b.width),height:Math.round(f*b.height),marginLeft:-Math.round(e*d.x1),marginTop:-Math.round(f*d.y1)});a("#rsmg_x1").val(d.x1);a("#rsmg_y1").val(d.y1);a("#rsmg_x2").val(d.x2);a("#rsmg_y2").val(d.y2);a("#rsmg_w").val(d.width);a("#rsmg_h").val(d.height)},x1:b.params.selection.x1,y1:b.params.selection.y1,x2:b.params.selection.x2,y2:b.params.selection.y2})})})}}})});a("div.rsmg_publish").unbind("click");a("div.rsmg_publish").click(function(b){b.preventDefault();if(a("#rsmg_item_detail").css("display")=="block"){return}var c=a(this);var d=c.parents("li.rsmg_item");var e=d.children('input[name="cid[]"]').val();if(c.hasClass("rsmg_publish_loading"))return false;if(c.hasClass("rsmg_published")){rsmg_unpublish_items(a,e,function(){c.children("span").html(rsmg_get_lang("RSMG_UNPUBLISHED"));c.addClass("rsmg_unpublished");c.removeClass("rsmg_publish_loading")},function(){c.removeClass("rsmg_published");c.addClass("rsmg_publish_loading")},true)}else{rsmg_publish_items(a,e,function(){c.children("span").html(rsmg_get_lang("RSMG_PUBLISHED"));c.addClass("rsmg_published");c.removeClass("rsmg_publish_loading")},function(){c.removeClass("rsmg_unpublished");c.addClass("rsmg_publish_loading")},true)}});a(".rsmg_preview").fancyZoom({scaleImg:true,closeOnClick:true})}function rsmg_init_tooltips(a){a("[title]").mbTooltip({opacity:.85,wait:200,cssClass:"default",timePerWord:70,hasArrow:true,hasShadow:true,imgPath:"components/com_rsmediagallery/assets/images/",ancor:"mouse",shadowColor:"black",mb_fade:200})}function rsmg_init_autocomplete(a){a("#rsmg_filter_text").autocomplete({source:function(b,c){if(b.term.length<2)return c([]);var d=a("#rsmg_operator .rsmg_tick").attr("rel");if(d=="is")d="contains";if(d=="is_not")d="contains_not";a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=getsuggestions&format=raw",dataType:"json",data:{filter_columns:a("#rsmg_column .rsmg_tick").attr("rel"),filter_operators:d,filter_values:b.term,dont_remember:1},success:function(a){c(a)}})}})}function rsmg_init_suckerfish(a){a(".rsmg_filter_toolbar > ul").children("li").each(function(b,c){maxwidth=0;a(c).children("ul").each(function(b,c){a(c).show();a(c).children("li").each(function(b,c){width=a(c).outerWidth();if(width>maxwidth)maxwidth=width});a(c).hide()});if(maxwidth>0)a(c).css("width",maxwidth+"px")});a(".rsmg_filter_toolbar ul").superfish();a("#rsmg_column ul li a").click(function(b){b.preventDefault();var c=a("<span>",{"class":"sf-sub-indicator"}).html(" &#187;");a(".rsmg_filter_toolbar ul").hideSuperfishUl();a("#rsmg_column > a").html(a(this).html());a("#rsmg_column > a").append(c);a("#rsmg_column ul li a").removeClass("rsmg_tick");a(this).addClass("rsmg_tick");if(a(this).attr("rel")=="published"){a("#rsmg_operator ul li").each(function(b,c){if(b>1){if(a(c).children(".rsmg_tick").length>0){if(b==2)a("#rsmg_operator ul li:nth-child(1) a").trigger("click");else a("#rsmg_operator ul li:nth-child(2) a").trigger("click")}a(c).hide()}});a("#rsmg_filter_text").val("1");a("#rsmg_filter_text").hide()}else{a("#rsmg_operator ul li").each(function(b,c){if(b>1)a(c).show()});if(a("#rsmg_filter_text").val()=="1")a("#rsmg_filter_text").val("");a("#rsmg_filter_text").show()}});a("#rsmg_operator ul li a").click(function(b){b.preventDefault();var c=a("<span>",{"class":"sf-sub-indicator"}).html(" &#187;");a(".rsmg_filter_toolbar ul").hideSuperfishUl();a("#rsmg_operator > a").html(a(this).html());a("#rsmg_operator > a").append(c);a("#rsmg_operator ul li a").removeClass("rsmg_tick");a(this).addClass("rsmg_tick")});a("#rsmg_order ul li a").click(function(b){b.preventDefault();var c=a("<span>",{"class":"sf-sub-indicator"}).html(" &#187;");a(".rsmg_filter_toolbar ul").hideSuperfishUl();a("#rsmg_order > a").html(a(this).html());a("#rsmg_order > a").append(c);a("#rsmg_order ul li a").removeClass("rsmg_tick");a(this).addClass("rsmg_tick")});a("#rsmg_direction ul li a").click(function(b){b.preventDefault();var c=a("<span>",{"class":"sf-sub-indicator"}).html(" &#187;");a(".rsmg_filter_toolbar ul").hideSuperfishUl();a("#rsmg_direction > a").html(a(this).html());a("#rsmg_direction > a").append(c);a("#rsmg_direction ul li a").removeClass("rsmg_tick");a(this).addClass("rsmg_tick")});a("#rsmg_limit ul li a").click(function(b){b.preventDefault();var c=a("<span>",{"class":"sf-sub-indicator"}).html(" &#187;");a(".rsmg_filter_toolbar ul").hideSuperfishUl();a("#rsmg_limit > a").html(a(this).html());a("#rsmg_limit > a").append(c);a("#rsmg_limit ul li a").removeClass("rsmg_tick");a(this).addClass("rsmg_tick")})}function rsmg_init_rumble(a){a(".rsmg_item").jrumble()}function rsmg_init_selectable(a){a("#rsmg_items").bind("mousedown",function(b){if(b.target){target=a(b.target);if(b.ctrlKey==true&&target!=a("#rsmg_items")){b.metaKey=true}if(target.hasClass("rsmg_action_button")&&a(window).scrollTop()==0){target.trigger("click")}}}).selectable({start:function(){a("#rsmg_select_all").attr("rel",0)},stop:function(){rsmg_show_selected(a)}})}function rsmg_init_sortable(a){a("#rsmg_items").removeAttr("style");is_disabled=a("#rsmg_order ul li a.rsmg_tick").attr("rel")=="ordering"?false:true;a("#rsmg_items").sortable({cursor:"auto",disabled:is_disabled,update:function(b,c){var d=[];var e=[];a('input[name="cid[]"]').each(function(b,c){rsmg_sort_array[b].id=a(c).val();d.push(rsmg_sort_array[b].id);e.push(rsmg_sort_array[b].ordering)});if(d.length>0){a.ajax({type:"POST",url:"index.php?option=com_rsmediagallery&controller=items&task=saveorder&format=raw",data:{"cid[]":d,"ordering[]":e}})}}});if(is_disabled)a("#rsmg_items").addClass("ui-sortable-disabled")}function rsmg_init_toolbar(a){a("#rsmg_toolbar_edit").addClass("rsmg_hidden");if(a("#toolbar-popup-options").length>0)a("#toolbar-popup-options a span").text(a("#toolbar-popup-options a").text());a("#rsmg_select_all").click(function(b){b.preventDefault();a(".rsmg_item").addClass("ui-selected");if(b.shiftKey)a("#rsmg_select_all").attr("rel",1);else a("#rsmg_select_all").attr("rel",0);rsmg_show_selected(a)});a("#rsmg_filter").click(function(b){b.preventDefault();if(a("#rsmg_filter_text").val().trim().length>0){var c=a("#rsmg_filter_text").val();if(a("#rsmg_column ul li a.rsmg_tick").attr("rel")!="published")a("#rsmg_filter_text").val("");var d=a("#rsmg_column .rsmg_tick").attr("rel");var e=a("#rsmg_operator .rsmg_tick").attr("rel");var f=document.getElementsByName("rsmg_columns[]");var g=document.getElementsByName("rsmg_operators[]");var h=document.getElementsByName("rsmg_values[]");for(var i=0;i<f.length;i++){if(a(f[i]).val()==d&&a(g[i]).val()==e&&a(h[i]).val()==c)return}var j=a("<li>");var k=a("<span>").html(a("#rsmg_column > a").html());var l=a("<span>").html(a("#rsmg_operator > a").html());var m=a("<strong>").text(c);var n=a("<a>",{href:"javascript: void(0)","class":"rsmg_close"}).click(function(b){b.preventDefault();a(this).parent("li").hide("highlight",500,function(){a(this).remove();rsmg_get_items(a,true);if(a("#rsmg_filters li").length==1&&a("#rsmg_clear_filters").length>0)a("#rsmg_clear_filters").remove()})});k.children(".sf-sub-indicator").remove();l.children(".sf-sub-indicator").remove();var o=a("<input>",{type:"hidden",name:"rsmg_columns[]",value:d});var p=a("<input>",{type:"hidden",name:"rsmg_operators[]",value:e});var q=a("<input>",{type:"hidden",name:"rsmg_values[]",value:c});if(d=="published"){m.text("");n.css({"margin-left":0,"padding-left":0,"border-left":0})}a("#rsmg_filters").append(j.append(k,l,m,n,o,p,q));a("#rsmg_clear_filters").remove();if(a("#rsmg_filters").children().length>2){var r=a("<li>",{id:"rsmg_clear_filters"}).html(rsmg_get_lang("RSMG_CLEAR_ALL_FILTERS")).click(function(b){b.preventDefault();a("#rsmg_filters").children().hide("highlight",500,function(){a(this).remove();rsmg_get_items(a,true)})});a("#rsmg_filters").append(r)}}rsmg_get_items(a,true)});a("#rsmg_filter_form").submit(function(b){b.preventDefault();a("#rsmg_filter").trigger("click")});a(".rsmg_close").click(function(b){b.preventDefault();a(this).parent("li").hide("highlight",500,function(){a(this).remove();rsmg_get_items(a,true);if(a("#rsmg_filters li").length==1&&a("#rsmg_clear_filters").length>0)a("#rsmg_clear_filters").remove()})});a("#rsmg_clear_filters").click(function(b){b.preventDefault();a("#rsmg_filters").children().hide("highlight",500,function(){a(this).remove();rsmg_get_items(a,true)})})}jQuery.noConflict();jQuery(document).ready(function(a){rsmg_init_toolbar(a);rsmg_init_suckerfish(a);rsmg_init_autocomplete(a);rsmg_get_items(a,false);rsmg_init_load_more(a);rsmg_init_details_buttons(a);rsmg_init_upload(a);if(a("#rsmg_dialog_no_items").length>0){a("#dialog:ui-dialog").dialog("destroy");a("#rsmg_dialog_no_items").dialog({height:400,width:400,modal:true,draggable:false,resizable:false,buttons:[{text:rsmg_get_lang("RSMG_CLOSE"),click:function(){a(this).dialog("close")}}]})}});var rsmg_sort_array=[]