(function(a){a.fn.fancyZoom=function(b){function p(){if(a.browser.msie&&a.browser.version>=7){n("png")}}function o(){if(a.browser.msie&&parseFloat(a.browser.version)>=7){n("gif")}}function n(b){a("#zoom_table td").each(function(c){var d=a(this).css("background-image").replace(/\.(png|gif|none)\"\)$/,"."+b+'")');a(this).css("background-image",d)});var c=i.children("img");var d=c.attr("src").replace(/\.(png|gif|none)$/,"."+b);c.attr("src",d)}function m(){if(d)return false;d=true;a("#zoom").unbind("click");o();if(i.attr("scaleImg")!="true"){j.html("")}i.hide();a("#zoom").animate({top:i.attr("curTop")+"px",left:i.attr("curLeft")+"px",opacity:"hide",width:"1px",height:"1px"},500,null,function(){if(i.attr("scaleImg")=="true"){j.html("")}p();d=false});return false}function l(c){var e=a(this).parents(".rsmg_item").find("img");if(d)return false;d=true;var f=a("<img>",{src:e.attr("original-src")});var g=e.attr("original-width")||800;var h=e.attr("original-height")||600;var k=parseInt(g)/parseInt(h);var l=a(window).height();var n=a(window).width();if(g>n){g=n*.7;h=g/k;f.attr("width",g);f.attr("height",h)}var q=window.innerWidth||window.document.documentElement.clientWidth||window.document.body.clientWidth;var r=window.innerHeight||window.document.documentElement.clientHeight||window.document.body.clientHeight;var s=window.pageXOffset||window.document.documentElement.scrollLeft||window.document.body.scrollLeft;var t=window.pageYOffset||window.document.documentElement.scrollTop||window.document.body.scrollTop;var u={width:q,height:r,x:s,y:t};var q=g;var r=h;var v=u;var w=Math.max(v.height/2-r/2+t,0);var x=v.width/2-q/2;var y=c.pageY;var z=c.pageX;i.attr("curTop",y);i.attr("curLeft",z);i.attr("scaleImg",b.scaleImg?"true":"false");a("#zoom").hide().css({position:"absolute",top:y+"px",left:z+"px",width:"1px",height:"1px","z-index":1e5});o();i.hide();if(b.closeOnClick){a("#zoom").click(m)}if(b.scaleImg){j.html(f);a("#zoom_content img").css("width","100%")}else{j.html("")}a("#zoom").animate({top:w+"px",left:x+"px",opacity:"show",width:q+"px",height:r+"px"},500,null,function(){if(b.scaleImg!=true){j.html(f)}p();i.show();d=false});return false}var b=b||{};var c=b&&b.directory?b.directory:"components/com_rsmediagallery/assets/images/fancyzoom";var d=false;if(a("#zoom").length==0){var e=a.browser.msie?"gif":"png";var f='<div id="zoom" style="display:none;"> \n                  <table id="zoom_table" style="border-collapse:collapse; width:100%; height:100%;"> \n                    <tbody> \n                      <tr> \n                        <td class="tl" style="background:url('+c+"/tl."+e+') 0 0 no-repeat; width:20px; height:20px; overflow:hidden;" /> \n                        <td class="tm" style="background:url('+c+"/tm."+e+') 0 0 repeat-x; height:20px; overflow:hidden;" /> \n                        <td class="tr" style="background:url('+c+"/tr."+e+') 100% 0 no-repeat; width:20px; height:20px; overflow:hidden;" /> \n                      </tr> \n                      <tr> \n                        <td class="ml" style="background:url('+c+"/ml."+e+') 0 0 repeat-y; width:20px; overflow:hidden;" /> \n                        <td class="mm" style="background:#fff; vertical-align:top; padding:10px;"> \n                          <div id="zoom_content"> \n                          </div> \n                        </td> \n                        <td class="mr" style="background:url('+c+"/mr."+e+') 100% 0 repeat-y;  width:20px; overflow:hidden;" /> \n                      </tr> \n                      <tr> \n                        <td class="bl" style="background:url('+c+"/bl."+e+') 0 100% no-repeat; width:20px; height:20px; overflow:hidden;" /> \n                        <td class="bm" style="background:url('+c+"/bm."+e+') 0 100% repeat-x; height:20px; overflow:hidden;" /> \n                        <td class="br" style="background:url('+c+"/br."+e+') 100% 100% no-repeat; width:20px; height:20px; overflow:hidden;" /> \n                      </tr> \n                    </tbody> \n                  </table> \n                  <a href="#" title="Close" id="zoom_close" style="position:absolute; top:0; left:0;"> \n                    <img src="'+c+"/closebox."+e+'" alt="Close" style="border:none; margin:0; padding:0;" /> \n                  </a> \n                </div>';a("body").append(f);a("html").click(function(b){if(a(b.target).parents("#zoom:visible").length==0)m()});a(document).keyup(function(b){if(b.keyCode==27&&a("#zoom:visible").length>0)m()});a("#zoom_close").click(m)}var g=a("#zoom");var h=a("#zoom_table");var i=a("#zoom_close");var j=a("#zoom_content");var k=a("td.ml,td.mm,td.mr");this.each(function(b){a(a(this).attr("href")).hide();a(this).click(l)});return this}})(jQuery)